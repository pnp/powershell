<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Invoke-PnPSPRestMethod | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Invoke-PnPSPRestMethod | PnP PowerShell ">
    <meta name="generator" content="docfx ">
  <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="../">
  <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Edit this page" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
  <h1 id="invoke-pnpsprestmethod">Invoke-PnPSPRestMethod</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p>Invokes a REST request towards a SharePoint site.</p>
<h2 id="syntax">SYNTAX</h2>
<pre><code class="lang-powershell">Invoke-PnPSPRestMethod -Url &lt;String&gt;
                       [-Method &lt;HttpRequestMethod&gt;]
                       [-Content &lt;Object&gt;]
                       [-ContentType &lt;String&gt;]
                       [-Raw]
                       [-Connection &lt;PnPConnection&gt;]
                       [-ResponseHeadersVariable &lt;String&gt;]
                       [-Batch &lt;PnPBatch&gt;]
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>Invokes a REST request towards a SharePoint site.</p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<pre><code class="lang-powershell">Invoke-PnPSPRestMethod -Url /_api/web
</code></pre>
<p>This example executes a GET request towards the current site collection and returns the properties of the current web.</p>
<h3 id="example-2">EXAMPLE 2</h3>
<pre><code class="lang-powershell">$output = Invoke-PnPSPRestMethod -Url '/_api/web/lists?$select=Id,Title'
$output.value
</code></pre>
<p>This example executes a GET request towards the current site collection and returns the id and title of all the lists and outputs them to the console. Notice the use of single quotes. If you want to use double quotes (&quot;) then you will have to escape the $ character with a backtick: `$</p>
<h3 id="example-3">EXAMPLE 3</h3>
<pre><code class="lang-powershell">$item = @{Title=&quot;Test&quot;}
Invoke-PnPSPRestMethod -Method Post -Url &quot;/_api/web/lists/GetByTitle('Test')/items&quot; -Content $item
</code></pre>
<p>This example creates a new item in the list 'Test' and sets the title field to 'Test'.</p>
<h3 id="example-4">EXAMPLE 4</h3>
<pre><code class="lang-powershell">$item = &quot;{'Title':'Test'}&quot;
Invoke-PnPSPRestMethod -Method Post -Url &quot;/_api/web/lists/GetByTitle('Test')/items&quot; -Content $item
</code></pre>
<p>This example creates a new item in the list 'Test' and sets the title field to 'Test'.</p>
<h3 id="example-5">EXAMPLE 5</h3>
<pre><code class="lang-powershell">$item = &quot;{ '__metadata': { 'type': 'SP.Data.TestListItem' }, 'Title': 'Test'}&quot;
Invoke-PnPSPRestMethod -Method Post -Url &quot;/_api/web/lists/GetByTitle('Test')/items&quot; -Content $item -ContentType &quot;application/json;odata=verbose&quot;
</code></pre>
<p>This example creates a new item in the list 'Test' and sets the title field to 'Test'.</p>
<h3 id="example-6">EXAMPLE 6</h3>
<pre><code class="lang-powershell">$output = Invoke-PnPSPRestMethod -Url '/_api/web/lists?$select=Id,Title' -ResponseHeadersVariable headers
$output.value
$headers
</code></pre>
<p>This example executes a GET request towards the current site collection and returns the id and title of all the lists and outputs them to the console. Notice the use of single quotes. If you want to use double quotes (&quot;) then you will have to escape the $ character with a backtick: `$</p>
<p>It will also store the response headers values in the PowerShell variable name that you specify. Enter a variable name without the dollar sign ($) symbol.</p>
<h3 id="example-7">EXAMPLE 7</h3>
<pre><code class="lang-powershell">$batch = New-PnPBatch -RetainRequests
Invoke-PnPSPRestMethod -Method Get -Url &quot;https://tenant.sharepoint.com/sites/mysite/_api/web/lists&quot; -Batch $batch
$item = &quot;{'Title':'Test'}&quot;
Invoke-PnPSPRestMethod -Method Post -Url &quot;https://tenant.sharepoint.com/sites/mysite/_api/web/lists/GetByTitle('Test')/items&quot; -Content $item -Batch $batch
$response = Invoke-PnPBatch $batch -Details
$response
</code></pre>
<p>This example executes a GET request to get all lists and a POST request to add an item to a list in a single batch request.
It is necessary to create and invoke batch requests in the manner specified here if you want to process something later on with the response object.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-content">-Content</h3>
<p>A string or object to send.</p>
<pre><code class="lang-yaml">Type: Object
Parameter Sets: (All)

Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-contenttype">-ContentType</h3>
<p>The content type of the object to send. Defaults to 'application/json'.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-method">-Method</h3>
<p>The Http method to execute. Defaults to GET.</p>
<pre><code class="lang-yaml">Type: HttpRequestMethod
Parameter Sets: (All)

Required: False
Position: 0
Accept pipeline input: False
</code></pre>
<h3 id="-url">-Url</h3>
<p>The url to execute</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: True
Position: 0
Accept pipeline input: False
</code></pre>
<h3 id="-raw">-Raw</h3>
<p>If specified the returned data will not be converted to an object but returned as a JSON string.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)

Required: True
Position: 0
Accept pipeline input: False
</code></pre>
<h3 id="-accept">-Accept</h3>
<p>The Accept HTTP request header. Defaults to 'application/json;odata=nometadata'.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-connection">-Connection</h3>
<p>Optional connection to be used by the cmdlet. Retrieve the value for this parameter by either specifying -ReturnConnection on Connect-PnPOnline or by executing Get-PnPConnection.</p>
<pre><code class="lang-yaml">Type: PnPConnection
Parameter Sets: (All)

Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-responseheadersvariable">-ResponseHeadersVariable</h3>
<p>Creates a variable containing a Response Headers Dictionary. Enter a variable name without the dollar sign ($) symbol. The keys of the dictionary contain the field names and values of the Response Header returned by the web server.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)
Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-batch">-Batch</h3>
<p>The batch to add this request to.</p>
<pre><code class="lang-yaml">Type: PnPBatch
Parameter Sets: Batched

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/m365pnp">Microsoft 365 Patterns and Practices</a></p>

</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
            <img src="https://m365-visitor-stats.azurewebsites.net/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "ag6usxufyq");
    </script>  </body>
</html>