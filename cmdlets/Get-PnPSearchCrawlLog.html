<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Get-PnPSearchCrawlLog | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Get-PnPSearchCrawlLog | PnP PowerShell ">
    <meta name="generator" content="docfx ">
  <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="../">
  <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Edit this page" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
  <h1 id="get-pnpsearchcrawllog">Get-PnPSearchCrawlLog</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p>Returns entries from the SharePoint search crawl log. Make sure you are granted access to the crawl log via the SharePoint search admin center at https://<tenant>-admin.sharepoint.com/_layouts/15/searchadmin/crawllogreadpermission.aspx in order to run this cmdlet.</tenant></p>
<h2 id="syntax">SYNTAX</h2>
<pre><code class="lang-powershell">Get-PnPSearchCrawlLog [-LogLevel &lt;LogLevel&gt;] [-RowLimit &lt;Int32&gt;] [-Filter &lt;String&gt;]
 [-ContentSource &lt;ContentSource&gt;] [-StartDate &lt;DateTime&gt;] [-EndDate &lt;DateTime&gt;] [-RawFormat]
 [-Connection &lt;PnPConnection&gt;] 
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>Allows to retrieve entries from the SharePoint search crawl log. To be able to use this command you need to grant access to the crawl log via the SharePoint search admin center at https://<tenant>-admin.sharepoint.com/_layouts/15/searchadmin/crawllogreadpermission.aspx.</tenant></p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<pre><code class="lang-powershell">Get-PnPSearchCrawlLog
</code></pre>
<p>Returns the last 100 crawl log entries for site content.</p>
<h3 id="example-2">EXAMPLE 2</h3>
<pre><code class="lang-powershell">Get-PnPSearchCrawlLog -Filter &quot;https://contoso-my.sharepoint.com/personal&quot;
</code></pre>
<p>Returns the last 100 crawl log entries for OneDrive content.</p>
<h3 id="example-3">EXAMPLE 3</h3>
<pre><code class="lang-powershell">Get-PnPSearchCrawlLog -ContentSource UserProfiles
</code></pre>
<p>Returns the last 100 crawl log entries for user profiles.</p>
<h3 id="example-4">EXAMPLE 4</h3>
<pre><code class="lang-powershell">Get-PnPSearchCrawlLog -ContentSource UserProfiles -Filter &quot;mikael&quot;
</code></pre>
<p>Returns the last 100 crawl log entries for user profiles with the term &quot;mikael&quot; in the user principal name.</p>
<h3 id="example-5">EXAMPLE 5</h3>
<pre><code class="lang-powershell">Get-PnPSearchCrawlLog -ContentSource Sites -LogLevel Error -RowLimit 10
</code></pre>
<p>Returns the last 10 crawl log entries with a state of Error for site content.</p>
<h3 id="example-6">EXAMPLE 6</h3>
<pre><code class="lang-powershell">Get-PnPSearchCrawlLog -EndDate (Get-Date).AddDays(-100)
</code></pre>
<p>Returns the last 100 crawl log entries up until 100 days ago.</p>
<h3 id="example-7">EXAMPLE 7</h3>
<pre><code class="lang-powershell">Get-PnPSearchCrawlLog -RowFilter 3 -RawFormat
</code></pre>
<p>Returns the last 3 crawl log entries showing the raw crawl log data.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-connection">-Connection</h3>
<p>Optional connection to be used by the cmdlet. Retrieve the value for this parameter by either specifying -ReturnConnection on Connect-PnPOnline or by executing Get-PnPConnection.</p>
<pre><code class="lang-yaml">Type: PnPConnection
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-contentsource">-ContentSource</h3>
<p>Content to retrieve (Sites, User Profiles). Defaults to Sites.</p>
<pre><code class="lang-yaml">Type: ContentSource
Parameter Sets: (All)
Accepted values: Sites, UserProfiles

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-enddate">-EndDate</h3>
<p>End date to stop getting entries from. Default to current time.</p>
<pre><code class="lang-yaml">Type: DateTime
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-filter">-Filter</h3>
<p>Filter to limit what is being returned. Has to be a URL prefix for SharePoint content, and part of a user principal name for user profiles. Wildcard characters are not supported.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-loglevel">-LogLevel</h3>
<p>Filter what log entries to return (All, Success, Warning, Error). Defaults to All</p>
<pre><code class="lang-yaml">Type: LogLevel
Parameter Sets: (All)
Accepted values: Success, Warning, Error, All

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-rawformat">-RawFormat</h3>
<p>Show raw crawl log data</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-rowlimit">-RowLimit</h3>
<p>Number of entries to return. Defaults to 100.</p>
<pre><code class="lang-yaml">Type: Int32
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-startdate">-StartDate</h3>
<p>Start date to start getting entries from. Defaults to start of time.</p>
<pre><code class="lang-yaml">Type: DateTime
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/m365pnp">Microsoft 365 Patterns and Practices</a></p>

</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
            <img src="https://m365-visitor-stats.azurewebsites.net/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "ag6usxufyq");
    </script>  </body>
</html>