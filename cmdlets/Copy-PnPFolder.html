<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Copy-PnPFolder | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Copy-PnPFolder | PnP PowerShell ">
    <meta name="generator" content="docfx ">
  <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="../">
  <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Edit this page" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
  <h1 id="copy-pnpfolder">Copy-PnPFolder</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p>Copies a folder or file to a different location within SharePoint Online or allows uploading of an entire local folder with optionally subfolders to SharePoint Online.</p>
<h2 id="syntax">SYNTAX</h2>
<h3 id="copy-files-within-microsoft-365">Copy files within Microsoft 365</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -SourceUrl &lt;String&gt; -TargetUrl &lt;String&gt; [-Overwrite] [-Force] [-IgnoreVersionHistory] [-NoWait] [-Connection &lt;PnPConnection&gt;] [-Verbose]
  
</code></pre>
<h3 id="copy-files-from-local-to-microsoft-365">Copy files from local to Microsoft 365</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -LocalPath &lt;String&gt; -TargetUrl &lt;String&gt; [-Overwrite] [-Recurse] [-RemoveAfterCopy] [-Connection &lt;PnPConnection&gt;] [-Verbose]
  
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>Copies a folder or file to a different location within SharePoiint. This location can be within the same document library, same site, same site collection or even to another site collection on the same tenant. Notice that if copying between sites or to a subsite you cannot specify a target filename, only a folder name.</p>
<p>Copying files and folders is bound to some restrictions. You can find more on it here: <a href="https://learn.microsoft.com/office365/servicedescriptions/sharepoint-online-service-description/sharepoint-online-limits#moving-and-copying-across-sites">https://learn.microsoft.com/office365/servicedescriptions/sharepoint-online-service-description/sharepoint-online-limits#moving-and-copying-across-sites</a></p>
<p>It can also accommodate copying an entire folder with all its files and optionally even subfolders and files from a local path onto SharePoint Online.</p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -SourceUrl &quot;Shared Documents/MyProjectfiles&quot; -TargetUrl &quot;/sites/otherproject/Shared Documents&quot; -Overwrite
</code></pre>
<p>Copies a folder named MyProjectFiles in the document library called Documents located in the current site to the root folder of the library named Documents in the site collection otherproject. If a folder named MyProjectFiles already exists, it will overwrite it.</p>
<h3 id="example-2">EXAMPLE 2</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -SourceUrl &quot;/sites/project/Shared Documents/company.docx&quot; -TargetUrl &quot;/sites/otherproject/Shared Documents&quot;
</code></pre>
<p>Copies a file named company.docx located in a document library called Shared Documents in the site collection project to the Shared Documents library in the site collection otherproject. If a file named company.docx already exists, it won't perform the copy.</p>
<h3 id="example-3">EXAMPLE 3</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -SourceUrl &quot;Shared Documents/company.docx&quot; -TargetUrl &quot;/sites/otherproject/Shared Documents&quot; -IgnoreVersionHistory
</code></pre>
<p>Copies a file named company.docx located in a document library called Documents in the current site to the site collection otherproject. If a file named company.docx already exists, it won't perform the copy. Only the latest version of the file will be copied and its history will be discarded.</p>
<h3 id="example-4">EXAMPLE 4</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -SourceUrl &quot;/sites/project/Shared Documents/Archive&quot; -TargetUrl &quot;/sites/otherproject/Shared Documents&quot; -Overwrite
</code></pre>
<p>Copies a folder named Archive located in a document library called Shared Documents in the site collection project to the Shared Documents library in the site collection otherproject. If a folder named Archive already exists, it will overwrite it.</p>
<h3 id="example-5">EXAMPLE 5</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -SourceUrl &quot;Documents/company.docx&quot; -TargetUrl &quot;Documents/company2.docx&quot;
</code></pre>
<p>Copies a file named company.docx located in a document library called Documents to a new document named company2.docx in the same library.</p>
<h3 id="example-6">EXAMPLE 6</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -SourceUrl &quot;Shared Documents/company.docx&quot; -TargetUrl &quot;Shared Documents2/company.docx&quot;
</code></pre>
<p>Copies a file named company.docx located in a document library called Documents to a document library called Documents2 in the same site.</p>
<h3 id="example-7">EXAMPLE 7</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -SourceUrl &quot;Shared DocuDocuments/company.docx&quot; -TargetUrl &quot;Subsite/Shared Documents&quot;
</code></pre>
<p>Copies a file named company.docx located in a document library called Documents to the document library named Documents in a subsite named Subsite keeping the file name.</p>
<h3 id="example-8">EXAMPLE 8</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -SourceUrl &quot;Shared Documents/company.docx&quot; -TargetUrl &quot;/sites/otherproject/Shared Documents&quot; -Overwrite
</code></pre>
<p>Copies a file named company.docx located in a document library called Documents in the current site to the site collection otherproject. If a file named company.docx already exists, it will still perform the copy and replace the original company.docx file.</p>
<h3 id="example-9">EXAMPLE 9</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -SourceUrl &quot;Shared Documents/MyDocs&quot; -TargetUrl &quot;/sites/otherproject/Documents&quot; -Overwrite
</code></pre>
<p>Copies a folder named MyDocs in the document library called Documents located in the current site to the site collection otherproject. If the MyDocs folder exist it will copy into it, if not it will be created.</p>
<h3 id="example-10">EXAMPLE 10</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -SourceUrl &quot;SubSite1/Documents/company.docx&quot; -TargetUrl &quot;SubSite2/Documents&quot;
</code></pre>
<p>Copies a file named company.docx in the library named Documents in SubSite1 to the library named Documents in SubSite2.</p>
<h3 id="example-11">EXAMPLE 11</h3>
<pre><code class="lang-powershell">$job = Copy-PnPFolder -SourceUrl &quot;Shared Documents/company.docx&quot; -TargetUrl &quot;SubSite2/Shared Documents&quot; -NoWait
$jobStatus = Receive-PnPCopyMoveJobStatus -Job $result
if($jobStatus.JobState == 0)
{
  Write-Host &quot;Job finished&quot;
}
</code></pre>
<p>Copies a file named company.docx from the current document library to the documents library in SubSite2. It will not wait for the action to return but returns job information instead. The Receive-PnPCopyMoveJobStatus cmdlet will return the job status.</p>
<h3 id="example-12">EXAMPLE 12</h3>
<pre><code class="lang-powershell">Copy-PnPFolder -LocalPath &quot;c:\temp&quot; -TargetUrl &quot;Subsite1/Shared Documents&quot; -Recurse -Overwrite
</code></pre>
<p>Copies all the files and underlying folders from the local folder c:\temp to the document library Shared Documents in Subsite1. If a file already exists, it will be overwritten.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-force">-Force</h3>
<p>If provided, no confirmation will be requested and the action will be performed</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: WITHINM365

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-ignoreversionhistory">-IgnoreVersionHistory</h3>
<p>If provided, only the latest version of the document will be copied and its history will be discarded. If not provided, all historical versions will be copied.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: WITHINM365

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-overwrite">-Overwrite</h3>
<p>If provided, if a file already exists at the TargetUrl, it will be overwritten. If omitted, the copy operation will be canceled if the file already exists at the TargetUrl location when copying between two locations on SharePoint Online. If copying files from a local path to SharePoint Online, it will skip any file that already exists and still continue with the next one.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-sourceurl">-SourceUrl</h3>
<p>Site or server relative URL specifying the file or folder to copy. Must include the file name if it is a file or the entire path to the folder if it is a folder.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: WITHINM365
Aliases: SiteRelativeUrl, ServerRelativeUrl

Required: True
Position: Named
Default value: None
Accept pipeline input: True (ByValue)
Accept wildcard characters: False
</code></pre>
<h3 id="-targeturl">-TargetUrl</h3>
<p>Site or server relative URL where to copy the file or folder to. Must not include the file name.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)
Aliases: TargetServerRelativeLibrary

Required: True
Position: 1
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-nowait">-NoWait</h3>
<p>If specified the task will return immediately after creating the copy job. The cmdlet will return a job object which can be used with Receive-PnPCopyMoveJobStatus to retrieve the status of the job.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: WITHINM365

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-recurse">-Recurse</h3>
<p>When copying files from a local folder to SharePoint Online, this parameter will copy all files and folders within the local folder and all of its subfolders as well.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: FROMLOCAL

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-removeaftercopy">-RemoveAfterCopy</h3>
<p>When copying files from a local folder to SharePoint Online, this parameter will remove all files locally that have successfully been uploaded to SharePoint Online. If a file fails, it will not be removed locally. Local folders will be removed after all files have been uploaded and the folder is empty.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: FROMLOCAL

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-verbose">-Verbose</h3>
<p>When provided, additional debug statements will be shown while executing the cmdlet.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/m365pnp">Microsoft 365 Patterns and Practices</a></p>

</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
            <img src="https://m365-visitor-stats.azurewebsites.net/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "ag6usxufyq");
    </script>  </body>
</html>