<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>New-PnPUPABulkImportJob | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="New-PnPUPABulkImportJob | PnP PowerShell ">
    <meta name="generator" content="docfx 2.51.0.0">
    <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="new-pnpupabulkimportjob">New-PnPUPABulkImportJob</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p><strong>Required Permissions</strong></p>
<ul>
<li>SharePoint: Access to the SharePoint Tenant Administration site</li>
</ul>
<p>Submit up a new user profile bulk import job.</p>
<h2 id="syntax">SYNTAX</h2>
<pre><code class="lang-powershell">New-PnPUPABulkImportJob [-Folder] &lt;String&gt; [-Path] &lt;String&gt; [-UserProfilePropertyMapping] &lt;Hashtable&gt;
 [-IdProperty] &lt;String&gt; [[-IdType] &lt;ImportProfilePropertiesUserIdType&gt;] [-Wait] [-Verbose] [-Connection &lt;PnPConnection&gt;]
 [&lt;CommonParameters&gt;]
</code></pre>
<pre><code class="lang-powershell">New-PnPUPABulkImportJob -Url &lt;String&gt; [-UserProfilePropertyMapping] &lt;Hashtable&gt;
 [-IdProperty] &lt;String&gt; [[-IdType] &lt;ImportProfilePropertiesUserIdType&gt;] [-Wait] [-Verbose] [-Connection &lt;PnPConnection&gt;]
 [&lt;CommonParameters&gt;]
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>See <a href="https://docs.microsoft.com/sharepoint/dev/solution-guidance/bulk-user-profile-update-api-for-sharepoint-online">https://docs.microsoft.com/sharepoint/dev/solution-guidance/bulk-user-profile-update-api-for-sharepoint-online</a> for information on the API and how the bulk import process works.</p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<pre><code class="lang-powershell">@&quot; 
 {
  &quot;value&quot;: [
    {
      &quot;IdName&quot;: &quot;mikaels@contoso.com&quot;,
      &quot;Department&quot;: &quot;PnP&quot;,
    },
	{
      &quot;IdName&quot;: &quot;vesaj@contoso.com&quot;,
      &quot;Department&quot;: &quot;PnP&quot;,
    }    
  ]
}
&quot;@ &gt; profiles.json

New-PnPUPABulkImportJob -Folder &quot;Shared Documents&quot; -Path profiles.json -IdProperty &quot;IdName&quot; -UserProfilePropertyMapping @{&quot;Department&quot;=&quot;Department&quot;}
</code></pre>
<p>This will submit a new user profile bulk import job to SharePoint Online using a local file.</p>
<h3 id="example-2">EXAMPLE 2</h3>
<pre><code class="lang-powershell">New-PnPUPABulkImportJob -Url &quot;https://{tenant}.sharepoint.com/Shared Documents/profiles.json&quot; -IdProperty &quot;IdName&quot; -UserProfilePropertyMapping @{&quot;Department&quot;=&quot;Department&quot;}
</code></pre>
<p>This will submit a new user profile bulk import job to SharePoint Online using an already uploaded file.</p>
<h3 id="example-3">EXAMPLE 3</h3>
<pre><code class="lang-powershell">New-PnPUPABulkImportJob -Url &quot;https://{tenant}.sharepoint.com/sites/userprofilesync/Shared Documents/profiles.json&quot; -IdProperty &quot;IdName&quot; -UserProfilePropertyMapping @{&quot;Department&quot;=&quot;Department&quot;} -Wait -Verbose
</code></pre>
<p>This will submit a new user profile bulk import job to SharePoint Online using an already uploaded file and will wait until the import has finished.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-folder">-Folder</h3>
<p>Site or server relative URL of the folder to where you want to store the import job file.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Submit up a new user profile bulk import job from local file

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-idproperty">-IdProperty</h3>
<p>The name of the property identifying the user in your JSON file to update the user profile for</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: True
Position: 3
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-idtype">-IdType</h3>
<p>The type of profile identifier (Email/CloudId/PrincipalName). Defaults to Email.</p>
<pre><code class="lang-yaml">Type: ImportProfilePropertiesUserIdType
Parameter Sets: (All)
Accepted values: Email, CloudId, PrincipalName

Required: False
Position: 4
Default value: Email
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-path">-Path</h3>
<p>The local file path of the JSON file to use for the user profile import</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Submit up a new user profile bulk import job from local file

Required: True
Position: 1
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-url">-Url</h3>
<p>The full url of the JSON file saved in SharePoint Online containing the identities and properties to import into the SharePoint Online User Profiles</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Submit up a new user profile bulk import job job from url

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-userprofilepropertymapping">-UserProfilePropertyMapping</h3>
<p>Specify user profile property mapping between the import file and UPA property names, i.e. <code>@{&quot;JobTitle&quot;=&quot;Title&quot;}</code> where the left side represents the property in the JSON file and the right side the name of the property in the SharePoint Online User Profile Service.</p>
<pre><code class="lang-yaml">Type: Hashtable
Parameter Sets: (All)

Required: True
Position: 2
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-connection">-Connection</h3>
<p>Optional connection to be used by the cmdlet. Retrieve the value for this parameter by either specifying -ReturnConnection on Connect-PnPOnline or by executing Get-PnPConnection.</p>
<pre><code class="lang-yaml">Type: PnPConnection
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-wait">-Wait</h3>
<p>Adding this parameter will cause the script to start the user profile sync operation and wait with proceeding with the rest of the script until the user profiles have been imported into the SharePoint Online user profile. It can take a long time for the user profile sync operation to complete. It will check every 30 seconds for the current status of the job, to avoid getting throttled. The check interval is non configurable.</p>
<p>Add <code>-Verbose</code> as well to be notified about the progress while waiting.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-verbose">-Verbose</h3>
<p>When provided, additional debug statements will be shown while going through the user profile sync steps.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/m365pnp">Microsoft 365 Patterns and Practices</a>
<a href="https://docs.microsoft.com/sharepoint/dev/solution-guidance/bulk-user-profile-update-api-for-sharepoint-online">Bulk update custom user profile properties for SharePoint Online</a></p>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "ag6usxufyq");
    </script>  </body>
</html>