<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Register-PnPAzureADApp | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Register-PnPAzureADApp | PnP PowerShell ">
    <meta name="generator" content="docfx ">
  <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="../">
  <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                <div class="pnp_tags">Available in the current Nightly Release only.</div>
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Edit this page" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
  <h1 id="register-pnpazureadapp">Register-PnPAzureADApp</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p>Registers an Azure AD App and optionally creates a new self-signed certificate to use with the application registration.</p>
<h2 id="syntax">SYNTAX</h2>
<h3 id="generate-certificate">Generate Certificate</h3>
<pre><code class="lang-powershell">Register-PnPAzureADApp -ApplicationName &lt;String&gt;
                                       -Tenant &lt;String&gt;
                                       [-DeviceLogin]
                                       [-CommonName &lt;String&gt;]
                                       [-OutPath &lt;String&gt;]
                                       [-Store &lt;StoreLocation&gt;]
                                       [-GraphApplicationPermissions &lt;Permission[]&gt;]
                                       [-GraphDelegatePermissions &lt;Permission[]&gt;]
                                       [-SharePointApplicationPermissions &lt;Permission[]&gt;]
                                       [-SharePointDelegatePermissions &lt;Permission[]&gt;]
                                       [-Country &lt;String&gt;]
                                       [-State &lt;String&gt;]
                                       [-Locality &lt;String&gt;]
                                       [-Organization &lt;String&gt;]
                                       [-OrganizationUnit &lt;String&gt;]
                                       [-ValidYears &lt;Int&gt;]
                                       [-CertificatePassword &lt;SecureString&gt;]
                                       [-LogoFilePath &lt;string&gt;]
                                       [-MicrosoftGraphEndPoint &lt;string&gt;]
                                       [-EntraIDLoginEndPoint &lt;string&gt;]
                                       [-SignInAudience &lt;EntraIDSignInAudience&gt;]
</code></pre>
<h3 id="existing-certificate">Existing Certificate</h3>
<pre><code class="lang-powershell">Register-PnPAzureADApp  -CertificatePath &lt;String&gt;
                        -ApplicationName &lt;String&gt;
                        -Tenant &lt;String&gt;
                        [-DeviceLogin]
                        [-GraphApplicationPermissions &lt;Permission[]&gt;]
                        [-GraphDelegatePermissions &lt;Permission[]&gt;]
                        [-SharePointApplicationPermissions &lt;Permission[]&gt;]
                        [-SharePointDelegatePermissions &lt;Permission[]&gt;]
                        [-CertificatePassword &lt;SecureString&gt;]
                        [-LogoFilePath &lt;string&gt;]
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>Registers an Azure AD App and optionally creates a new self-signed certificate to use with the application registration.</p>
<p>Note: if you want to use the newly created app to authenticate with username/password. Use <code>Register-PnPEntraIDAppForInteractiveLogin</code> to create an app that allows users to login with.</p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<pre><code class="lang-powershell">Register-PnPAzureADApp -ApplicationName TestApp -Tenant yourtenant.onmicrosoft.com -Store CurrentUser
</code></pre>
<p>Creates a new Azure AD Application registration, creates a new self signed certificate, and adds it to the local certificate store. It will upload the certificate to the azure app registration and it will request the following permissions: Sites.FullControl.All, Group.ReadWrite.All, User.Read.All. A browser window will be shown allowing you to authenticate.</p>
<h3 id="example-2">EXAMPLE 2</h3>
<pre><code class="lang-powershell">Register-PnPAzureADApp -ApplicationName TestApp -Tenant yourtenant.onmicrosoft.com -CertificatePath c:\certificate.pfx -CertificatePassword (ConvertTo-SecureString -String &quot;password&quot; -AsPlainText -Force)
</code></pre>
<p>Creates a new Azure AD Application registration which will use the existing private key certificate at the provided path to allow access. It will upload the provided private key certificate to the azure app registration and it will request the following permissions: Sites.FullControl.All, Group.ReadWrite.All, User.Read.All. A browser window will be shown allowing you to authenticate.</p>
<h3 id="example-3">EXAMPLE 3</h3>
<pre><code class="lang-powershell">Register-PnPAzureADApp -ApplicationName TestApp -Tenant yourtenant.onmicrosoft.com -Store CurrentUser -GraphApplicationPermissions &quot;User.Read.All&quot; -SharePointApplicationPermissions &quot;Sites.Read.All&quot;
</code></pre>
<p>Creates a new Azure AD Application registration, creates a new self signed certificate, and adds it to the local certificate store. It will upload the certificate to the azure app registration and it will request the following permissions: Sites.Read.All, User.Read.All. A browser window will be shown allowing you to authenticate.</p>
<h3 id="example-4">EXAMPLE 4</h3>
<pre><code class="lang-powershell">Register-PnPAzureADApp -ApplicationName TestApp -Tenant yourtenant.onmicrosoft.com -OutPath c:\ -CertificatePassword (ConvertTo-SecureString -String &quot;password&quot; -AsPlainText -Force)
</code></pre>
<p>Creates a new Azure AD Application registration, creates a new self signed certificate, and stores the public and private key certificates in c:. The private key certificate will be locked with the password &quot;password&quot;. It will upload the certificate to the azure app registration and it will request the following permissions: Sites.FullControl.All, Group.ReadWrite.All, User.Read.All. A browser window will be shown allowing you to authenticate.</p>
<h3 id="example-5">EXAMPLE 5</h3>
<pre><code class="lang-powershell">Register-PnPAzureADApp -DeviceLogin -ApplicationName TestApp -Tenant yourtenant.onmicrosoft.com -CertificatePath c:\certificate.pfx -CertificatePassword (ConvertTo-SecureString -String &quot;password&quot; -AsPlainText -Force) 
</code></pre>
<p>Creates a new Azure AD Application registration and asks you to authenticate using device login methods, creates a new self signed certificate, and adds it to the local certificate store. It will upload the certificate to the azure app registration and it will request the following permissions: Sites.FullControl.All, Group.ReadWrite.All, User.Read.All</p>
<h3 id="example-6">EXAMPLE 6</h3>
<pre><code class="lang-powershell">Register-PnPAzureADApp -ApplicationName TestApp -Tenant yourtenant.onmicrosoft.com -CertificatePath c:\certificate.pfx -CertificatePassword (ConvertTo-SecureString -String &quot;password&quot; -AsPlainText -Force) 
</code></pre>
<p>Creates a new Azure AD Application registration and asks you to authenticate using username and password, creates a new self signed certificate, and adds it to the local certificate store. It will upload the certificate to the azure app registration and it will request the following permissions: Sites.FullControl.All, Group.ReadWrite.All, User.Read.All</p>
<h3 id="example-7">EXAMPLE 7</h3>
<pre><code class="lang-powershell">Register-PnPAzureADApp -ApplicationName TestApp -Tenant yourtenant.onmicrosoft.com -CertificatePath c:\certificate.pfx -CertificatePassword (ConvertTo-SecureString -String &quot;password&quot; -AsPlainText -Force) -LogoFilePath c:\logo.png
</code></pre>
<p>Creates a new Azure AD Application registration which will use the existing private key certificate at the provided path to allow access. It will upload the provided private key certificate to the azure app registration and it will request the following permissions: Sites.FullControl.All, Group.ReadWrite.All, User.Read.All. It will also set the <code>logo.png</code> file as the logo for the Azure AD app.</p>
<h3 id="example-8">EXAMPLE 8</h3>
<pre><code class="lang-powershell">Register-PnPAzureADApp -ApplicationName &quot;ACS App&quot; -Tenant yourtenant.onmicrosoft.com -OutPath c:\temp -GraphApplicationPermissions &quot;User.Read.All&quot; -GraphDelegatePermissions &quot;Sites.Read.All&quot; -SharePointApplicationPermissions &quot;Sites.Read.All&quot; -SharePointDelegatePermissions &quot;AllSites.Read&quot;
</code></pre>
<p>Creates a new Azure AD Application registration, creates a new self signed certificate, writes it to the c:\temp folder. It will upload the certificate to the azure app registration and it will request the shown permissions. A browser window will be shown allowing you to authenticate.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-devicelogin">-DeviceLogin</h3>
<p>If specified, a device login flow, supporting Multi-Factor Authentication will be used to authenticate towards the Microsoft Graph.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)

Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-applicationname">-ApplicationName</h3>
<p>The name of the Azure AD Application to create.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: True
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-certificatepassword">-CertificatePassword</h3>
<p>Optional certificate password.</p>
<pre><code class="lang-yaml">Type: SecureString
Parameter Sets: (All)

Required: False
Position: 8
Accept pipeline input: False
</code></pre>
<h3 id="-certificatepath">-CertificatePath</h3>
<p>File path to use an existing certificate.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Existing Certificate

Required: True
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-commonname">-CommonName</h3>
<p>Common Name (e.g. server FQDN or YOUR name). It defaults to 'pnp.contoso.com'</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Generate Certificate

Required: False
Position: 0
Accept pipeline input: False
</code></pre>
<h3 id="-country">-Country</h3>
<p>Country Name (2 letter code).</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Generate Certificate

Required: False
Position: 1
Accept pipeline input: False
</code></pre>
<h3 id="-locality">-Locality</h3>
<p>Locality Name (eg. city).</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Generate Certificate

Required: False
Position: 3
Accept pipeline input: False
</code></pre>
<h3 id="-organization">-Organization</h3>
<p>Organization Name (eg. company).</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Generate Certificate

Required: False
Position: 4
Accept pipeline input: False
</code></pre>
<h3 id="-organizationunit">-OrganizationUnit</h3>
<p>Organizational Unit Name (eg. section).</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Generate Certificate

Required: False
Position: 5
Accept pipeline input: False
</code></pre>
<h3 id="-outpath">-OutPath</h3>
<p>Folder to create certificate files in (.CER and .PFX).</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Generate Certificate

Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-graphapplicationpermissions">-GraphApplicationPermissions</h3>
<p>Specify which Microsoft Graph Application permissions to request.</p>
<pre><code class="lang-yaml">Type: Permission[]
Parameter Sets: Generate Certificate

Required: False
Position: 0
Accept pipeline input: False
</code></pre>
<h3 id="-graphdelegatepermissions">-GraphDelegatePermissions</h3>
<p>Specify which Microsoft Graph Delegate permissions to request.</p>
<pre><code class="lang-yaml">Type: Permission[]
Parameter Sets: Generate Certificate

Required: False
Position: 0
Accept pipeline input: False
</code></pre>
<h3 id="-sharepointapplicationpermissions">-SharePointApplicationPermissions</h3>
<p>Specify which Microsoft SharePoint Application permissions to request.</p>
<pre><code class="lang-yaml">Type: Permission[]
Parameter Sets: Generate Certificate

Required: False
Position: 0
Accept pipeline input: False
</code></pre>
<h3 id="-sharepointdelegatepermissions">-SharePointDelegatePermissions</h3>
<p>Specify which Microsoft SharePoint Delegate permissions to request.</p>
<pre><code class="lang-yaml">Type: Permission[]
Parameter Sets: Generate Certificate

Required: False
Position: 0
Accept pipeline input: False
</code></pre>
<h3 id="-state">-State</h3>
<p>State or Province Name (full name).</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Generate Certificate

Required: False
Position: 2
Accept pipeline input: False
</code></pre>
<h3 id="-store">-Store</h3>
<p>Local Certificate Store to add the certificate to. Only works on Microsoft Windows.</p>
<pre><code class="lang-yaml">Type: StoreLocation
Parameter Sets: Generate Certificate

Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-tenant">-Tenant</h3>
<p>The identifier of your tenant, e.g. mytenant.onmicrosoft.com</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: True
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-validyears">-ValidYears</h3>
<p>Number of years until expiration (default is 10, max is 30).</p>
<pre><code class="lang-yaml">Type: Int
Parameter Sets: Generate Certificate

Required: False
Position: 7
Accept pipeline input: False
</code></pre>
<h3 id="-azureenvironment">-AzureEnvironment</h3>
<p>The Azure environment to use for authentication, the defaults to 'Production' which is the main Azure environment.</p>
<pre><code class="lang-yaml">Type: AzureEnvironment
Parameter Sets: (All)
Aliases:
Accepted values: Production, PPE, China, Germany, USGovernment, USGovernmentHigh, USGovernmentDoD, Custom

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-logofilepath">-LogoFilePath</h3>
<p>Sets the logo for the Azure AD application. Provide a full path to a local image file on your disk which you want to use as the logo.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-entraidloginendpoint">-EntraIDLoginEndPoint</h3>
<p>Sets the EntraID login endpoint to be used for creation of the app. This only works if Azure Environment parameter is set to <code>Custom</code></p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-microsoftgraphendpoint">-MicrosoftGraphEndPoint</h3>
<p>Sets the Microsoft Graph endpoint to be used for creation of the app. This only works if Azure Environment parameter is set to <code>Custom</code></p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h3 id="-signinaudience">-SignInAudience</h3>
<p>Sets the sign in audience. Use this to make the app support Single tenant accounts, Multi-tenant accounts, Multi-tenant + personal accounts &amp; personal accounts only.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Generate Certificate

Required: False
Position: Named
Accept pipeline input: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/m365pnp">Microsoft 365 Patterns and Practices</a></p>

</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
            <img src="https://m365-visitor-stats.azurewebsites.net/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "ag6usxufyq");
    </script>  </body>
</html>