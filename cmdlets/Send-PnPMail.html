<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Send-PnPMail | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Send-PnPMail | PnP PowerShell ">
    <meta name="generator" content="docfx ">
  <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="../">
  <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                <div class="pnp_tags">Available in the current Nightly Release only.</div>
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Edit this page" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
  <h1 id="send-pnpmail">Send-PnPMail</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p>Allows sending an e-mail</p>
<h2 id="syntax">SYNTAX</h2>
<h3 id="send-through-microsoft-graph-with-attachments-from-local-file-system">Send through Microsoft Graph with attachments from local file system</h3>
<pre><code class="lang-powershell">Send-PnPMail -From &lt;String&gt; -To &lt;String[]&gt; -Subject &lt;String&gt; -Body &lt;String&gt; [-Cc &lt;String[]&gt;] [-Bcc &lt;String[]&gt;] [-ReplyTo &lt;String[]&gt;] [-Importance &lt;MessageImportanceType&gt;] [-BodyContentType &lt;MessageBodyContentType&gt;] [-SaveToSentItems &lt;bool&gt;] [-Connection &lt;PnPConnection&gt;] [-Verbose] [-Attachments &lt;String[]&gt;]
</code></pre>
<h3 id="send-through-microsoft-graph-with-attachments-from-sharepoint-online">Send through Microsoft Graph with attachments from SharePoint Online</h3>
<pre><code class="lang-powershell">Send-PnPMail -From &lt;String&gt; -To &lt;String[]&gt; -Subject &lt;String&gt; -Body &lt;String&gt; [-Cc &lt;String[]&gt;] [-Bcc &lt;String[]&gt;] [-ReplyTo &lt;String[]&gt;] [-Importance &lt;MessageImportanceType&gt;] [-BodyContentType &lt;MessageBodyContentType&gt;] [-SaveToSentItems &lt;bool&gt;] [-Connection &lt;PnPConnection&gt;] [-Verbose] [-Files &lt;String[]&gt;]
</code></pre>
<h3 id="send-through-sharepoint-online-default">Send through SharePoint Online (Default)</h3>
<pre><code class="lang-powershell">Send-PnPMail -To &lt;String[]&gt; -Subject &lt;String&gt; -Body &lt;String&gt; [-Cc &lt;String[]&gt;] [-Bcc &lt;String[]&gt;] [-Connection &lt;PnPConnection&gt;] [-Verbose]
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>Allows sending an e-mail through SharePoint Online or Microsoft Graph. Sending e-mail through Microsoft Graph requires the <strong>Mail.Send</strong> permission.</p>
<p>In October 2025, <a href="https://support.microsoft.com/office/retirement-of-the-sharepoint-sendemail-api-b35bbab1-7d09-455f-8737-c2de63fe0821">Microsoft will remove the API</a> which is being used to send e-mail through SharePoint. It is therefore highly recommended to use the Microsoft Graph option listed above instead.</p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<pre><code class="lang-powershell">Send-PnPMail -From &quot;user@contoso.onmicrosoft.com&quot; -To &quot;recipient@contoso.com&quot; -Subject &quot;Test message&quot; -Body &quot;This is a test message&quot;
</code></pre>
<p>Sends an e-mail using Microsoft Graph to one recipient. E-mail is sent from the user specified in the From parameter and can be sent to both internal and external addresses. A copy of the sent e-mail will be stored in the mailbox of the user specified in the From parameter.</p>
<h3 id="example-2">EXAMPLE 2</h3>
<pre><code class="lang-powershell">Send-PnPMail -From &quot;sharedmailbox@contoso.onmicrosoft.com&quot; -To &quot;recipient1@contoso.com&quot;,&quot;recipient2@contoso.com&quot;,&quot;recipient3@contoso.com&quot; -Cc &quot;recipient4@contoso.com&quot; -Bcc &quot;recipient5@contoso.com&quot; -Subject &quot;Test message&quot; -Body &quot;This is a test message&quot; -Importance Low
</code></pre>
<p>Sends an e-mail using Microsoft Graph from a shared mailbox to multiple recipients. E-mail is sent from the shared mailbox specified in the From parameter and can be sent to both internal and external addresses. A copy of the sent e-mail will be stored in the shared mailbox.</p>
<h3 id="example-3">EXAMPLE 3</h3>
<pre><code class="lang-powershell">Send-PnPMail -To &quot;address@tenant.microsoftonline.com&quot; -Subject &quot;Test message&quot; -Body &quot;This is a test message&quot;
</code></pre>
<p>Sends an e-mail using the SharePoint Online SendEmail method using the current context. E-mail is sent from the SharePoint Online no-reply e-mail address and can only be sent to accounts in the same tenant. The from address will show the title of the site you are connected with along with the e-mail address no-reply@sharepointonline.com.</p>
<h3 id="example-4">EXAMPLE 4</h3>
<pre><code class="lang-powershell">Send-PnPMail -From &quot;user@contoso.onmicrosoft.com&quot; -To &quot;recipient@contoso.com&quot; -Subject &quot;Test message&quot; -Body &quot;This is a test message&quot; -Attachments &quot;C:\PnPCommunity\Test\test.docx&quot;
</code></pre>
<p>Sends an e-mail using Microsoft Graph to one recipient. E-mail is sent from the user specified in the From parameter and can be sent to both internal and external addresses. A copy of the sent e-mail will be stored in the mailbox of the user specified in the From parameter. It will also upload the file from the local file system as attachment.</p>
<h3 id="example-5">EXAMPLE 5</h3>
<pre><code class="lang-powershell">Send-PnPMail -From &quot;user@contoso.onmicrosoft.com&quot; -To &quot;recipient@contoso.com&quot; -Subject &quot;Test message&quot; -Body &quot;This is a test message&quot; -Files &quot;/sites/test/Shared Documents/Test.docx&quot;
</code></pre>
<p>Sends an e-mail using Microsoft Graph to one recipient. E-mail is sent from the user specified in the From parameter and can be sent to both internal and external addresses. A copy of the sent e-mail will be stored in the mailbox of the user specified in the From parameter. It will also upload the file from the SharePoint site collection and send it as attachment.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-body">-Body</h3>
<p>Body of the email. Accepts simple HTML as <code>&amp;lt;h1&amp;gt;&amp;lt;/h1&amp;gt;</code>, <code>&amp;lt;br/&amp;gt;</code> etc.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-cc">-Cc</h3>
<p>List of recipients on CC</p>
<pre><code class="lang-yaml">Type: String[]
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-bcc">-Bcc</h3>
<p>List of recipients on BCC</p>
<pre><code class="lang-yaml">Type: String[]
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-bodycontenttype">-BodyContentType</h3>
<p>Allows defining what type of content is in the Body parameter. Defaults to HTML.</p>
<pre><code class="lang-yaml">Type: MessageBodyContentType
Parameter Sets: Send through Microsoft Graph
Accepted values: Html, Text

Required: False
Position: Named
Default value: Html
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-connection">-Connection</h3>
<p>Optional connection to be used by the cmdlet. Retrieve the value for this parameter by either specifying -ReturnConnection on Connect-PnPOnline or by executing Get-PnPConnection.</p>
<pre><code class="lang-yaml">Type: PnPConnection
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-from">-From</h3>
<p>The sender of the e-mail. When Microsoft Graph is used, this can be a user or a shared mailbox.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Send through Microsoft Graph

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-importance">-Importance</h3>
<p>Allows defining what the importance of the e-mail is. Defaults to Normal.</p>
<pre><code class="lang-yaml">Type: MessageImportanceType
Parameter Sets: Send through Microsoft Graph
Accepted values: Low, Normal, High

Required: False
Position: Named
Default value: Normal
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-replyto">-ReplyTo</h3>
<p>List of return addresses to use for the e-mail</p>
<pre><code class="lang-yaml">Type: String[]
Parameter Sets: Send through Microsoft Graph

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-savetosentitems">-SaveToSentItems</h3>
<p>Allows indicating if the sent e-mail should be stored in the Sent Items of the mailbox used to send out the e-mail.</p>
<pre><code class="lang-yaml">Type: String[]
Parameter Sets: Send through Microsoft Graph

Required: False
Position: Named
Default value: True
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-subject">-Subject</h3>
<p>Subject of the email</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-to">-To</h3>
<p>List of recipients as a string array</p>
<pre><code class="lang-yaml">Type: String[]
Parameter Sets: (All)

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-attachments">-Attachments</h3>
<p>List of attachments from local file system to be uploaded and sent as attachments.</p>
<pre><code class="lang-yaml">Type: String[]
Parameter Sets: Send through Microsoft Graph

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-files">-Files</h3>
<p>List of files from the SharePoint site collection to be sent as attachments.</p>
<pre><code class="lang-yaml">Type: String[]
Parameter Sets: Send through Microsoft Graph

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/m365pnp">Microsoft 365 Patterns and Practices</a></p>

</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
            <img src="https://m365-visitor-stats.azurewebsites.net/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "ag6usxufyq");
    </script>  </body>
</html>