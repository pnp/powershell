<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Add-PnPCustomAction | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Add-PnPCustomAction | PnP PowerShell ">
    <meta name="generator" content="docfx ">
  <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="../">
  <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Edit this page" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
  <h1 id="add-pnpcustomaction">Add-PnPCustomAction</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p>Adds a custom action</p>
<h2 id="syntax">SYNTAX</h2>
<h3 id="default">Default</h3>
<pre><code class="lang-powershell">Add-PnPCustomAction -Name &lt;String&gt; -Title &lt;String&gt; -Description &lt;String&gt; -Group &lt;String&gt; -Location &lt;String&gt;
 [-Sequence &lt;Int32&gt;] [-Url &lt;String&gt;] [-ImageUrl &lt;String&gt;] [-CommandUIExtension &lt;String&gt;]
 [-RegistrationId &lt;String&gt;] [-Rights &lt;PermissionKind[]&gt;] [-RegistrationType &lt;UserCustomActionRegistrationType&gt;]
 [-Scope &lt;CustomActionScope&gt;] [-Connection &lt;PnPConnection&gt;] 
</code></pre>
<h3 id="client-side-component-id">Client Side Component Id</h3>
<pre><code class="lang-powershell">Add-PnPCustomAction -Name &lt;String&gt; -Title &lt;String&gt; -Location &lt;String&gt; [-Sequence &lt;Int32&gt;]
 [-RegistrationId &lt;String&gt;] [-RegistrationType &lt;UserCustomActionRegistrationType&gt;] [-Scope &lt;CustomActionScope&gt;]
 -ClientSideComponentId &lt;Guid&gt; [-ClientSideComponentProperties &lt;String&gt;]
 [-ClientSideHostProperties &lt;String&gt;] [-Connection &lt;PnPConnection&gt;] 
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>Adds a user custom action to a web or sitecollection.</p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<pre><code class="lang-powershell">$cUIExtn = &quot;&lt;CommandUIExtension&gt;&lt;CommandUIDefinitions&gt;&lt;CommandUIDefinition Location=&quot;&quot;Ribbon.List.Share.Controls._children&quot;&quot;&gt;&lt;Button Id=&quot;&quot;Ribbon.List.Share.GetItemsCountButton&quot;&quot; Alt=&quot;&quot;Get list items count&quot;&quot; Sequence=&quot;&quot;11&quot;&quot; Command=&quot;&quot;Invoke_GetItemsCountButtonRequest&quot;&quot; LabelText=&quot;&quot;Get Items Count&quot;&quot; TemplateAlias=&quot;&quot;o1&quot;&quot; Image32by32=&quot;&quot;_layouts/15/images/placeholder32x32.png&quot;&quot; Image16by16=&quot;&quot;_layouts/15/images/placeholder16x16.png&quot;&quot; /&gt;&lt;/CommandUIDefinition&gt;&lt;/CommandUIDefinitions&gt;&lt;CommandUIHandlers&gt;&lt;CommandUIHandler Command=&quot;&quot;Invoke_GetItemsCountButtonRequest&quot;&quot; CommandAction=&quot;&quot;javascript: alert('Total items in this list: '+ ctx.TotalListItems);&quot;&quot; EnabledScript=&quot;&quot;javascript: function checkEnable() { return (true);} checkEnable();&quot;&quot;/&gt;&lt;/CommandUIHandlers&gt;&lt;/CommandUIExtension&gt;&quot;

Add-PnPCustomAction -Name 'GetItemsCount' -Title 'Invoke GetItemsCount Action' -Description 'Adds custom action to custom list ribbon' -Group 'SiteActions' -Location 'CommandUI.Ribbon' -CommandUIExtension $cUIExtn
</code></pre>
<p>Adds a new custom action to the custom list template, and sets the Title, Name and other fields with the specified values. On click it shows the number of items in that list. Notice: escape quotes in CommandUIExtension.</p>
<h3 id="example-2">EXAMPLE 2</h3>
<pre><code class="lang-powershell">Add-PnPCustomAction -Title &quot;CollabFooter&quot; -Name &quot;CollabFooter&quot; -Location &quot;ClientSideExtension.ApplicationCustomizer&quot; -ClientSideComponentId c0ab3b94-8609-40cf-861e-2a1759170b43 -ClientSideComponentProperties &quot;{`&quot;sourceTermSet`&quot;:`&quot;PnP-CollabFooter-SharedLinks`&quot;,`&quot;personalItemsStorageProperty`&quot;:`&quot;PnP-CollabFooter-MyLinks`&quot;}&quot;
</code></pre>
<p>Adds a new application customizer to the site. This requires that an SPFX solution has been deployed containing the application customizer specified. Be sure to run Install-PnPApp before trying this cmdlet on a site.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-clientsidecomponentid">-ClientSideComponentId</h3>
<p>The Client Side Component Id of the custom action</p>
<pre><code class="lang-yaml">Type: Guid
Parameter Sets: Client Side Component Id

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-clientsidecomponentproperties">-ClientSideComponentProperties</h3>
<p>The Client Side Component Properties of the custom action. Specify values as a json string : &quot;{Property1 : 'Value1', Property2: 'Value2'}&quot;</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Client Side Component Id

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-clientsidehostproperties">-ClientSideHostProperties</h3>
<p>The Client Side Host Properties of the custom action. Specify values as a json string : &quot;{'preAllocatedApplicationCustomizerTopHeight': '50', 'preAllocatedApplicationCustomizerBottomHeight': '50'}&quot;</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Client Side Component Id

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-commanduiextension">-CommandUIExtension</h3>
<p>XML fragment that determines user interface properties of the custom action</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Default

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-connection">-Connection</h3>
<p>Optional connection to be used by the cmdlet. Retrieve the value for this parameter by either specifying -ReturnConnection on Connect-PnPOnline or by executing Get-PnPConnection.</p>
<pre><code class="lang-yaml">Type: PnPConnection
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-description">-Description</h3>
<p>The description of the custom action</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Default

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-group">-Group</h3>
<p>The group where this custom action needs to be added like 'SiteActions'</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Default

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-imageurl">-ImageUrl</h3>
<p>The URL of the image associated with the custom action</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Default

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-location">-Location</h3>
<p>The actual location where this custom action need to be added like 'CommandUI.Ribbon'</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-name">-Name</h3>
<p>The name of the custom action</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-registrationid">-RegistrationId</h3>
<p>The identifier of the object associated with the custom action.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-registrationtype">-RegistrationType</h3>
<p>Specifies the type of object associated with the custom action</p>
<pre><code class="lang-yaml">Type: UserCustomActionRegistrationType
Parameter Sets: (All)
Accepted values: None, List, ContentType, ProgId, FileType

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-rights">-Rights</h3>
<p>A string array that contain the permissions needed for the custom action</p>
<pre><code class="lang-yaml">Type: PermissionKind[]
Parameter Sets: Default
Accepted values: EmptyMask, ViewListItems, AddListItems, EditListItems, DeleteListItems, ApproveItems, OpenItems, ViewVersions, DeleteVersions, CancelCheckout, ManagePersonalViews, ManageLists, ViewFormPages, AnonymousSearchAccessList, Open, ViewPages, AddAndCustomizePages, ApplyThemeAndBorder, ApplyStyleSheets, ViewUsageData, CreateSSCSite, ManageSubwebs, CreateGroups, ManagePermissions, BrowseDirectories, BrowseUserInfo, AddDelPrivateWebParts, UpdatePersonalWebParts, ManageWeb, AnonymousSearchAccessWebLists, UseClientIntegration, UseRemoteAPIs, ManageAlerts, CreateAlerts, EditMyUserInfo, EnumeratePermissions, FullMask

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-scope">-Scope</h3>
<p>The scope of the CustomAction to add to. Either Web or Site; defaults to Web. 'All' is not valid for this command.</p>
<pre><code class="lang-yaml">Type: CustomActionScope
Parameter Sets: (All)
Accepted values: Web, Site, All

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-sequence">-Sequence</h3>
<p>Sequence of this CustomAction being injected. Use when you have a specific sequence with which to have multiple CustomActions being added to the page.</p>
<pre><code class="lang-yaml">Type: Int32
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-title">-Title</h3>
<p>The title of the custom action</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-url">-Url</h3>
<p>The URL, URI or ECMAScript (JScript, JavaScript) function associated with the action</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Default

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/m365pnp">Microsoft 365 Patterns and Practices</a>
<a href="https://learn.microsoft.com/previous-versions/office/sharepoint-server/ee539583(v=office.15)">UserCustomAction</a>
<a href="https://learn.microsoft.com/previous-versions/office/sharepoint-server/ee543321(v=office.15)">BasePermissions</a></p>

</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
            <img src="https://m365-visitor-stats.azurewebsites.net/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "ag6usxufyq");
    </script>  </body>
</html>