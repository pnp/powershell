<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Set-PnPSiteVersionPolicy | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Set-PnPSiteVersionPolicy | PnP PowerShell ">
    <meta name="generator" content="docfx ">
  <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="../">
  <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Edit this page" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
  <h1 id="set-pnpsiteversionpolicy">Set-PnPSiteVersionPolicy</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p>Sets file version policy related properties on the site.</p>
<p><strong>Required Permissions</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>API/ Permission Name</th>
<th>Admin consent required</th>
</tr>
</thead>
<tbody>
<tr>
<td>Delegated</td>
<td>AllSites.FullControl</td>
<td>yes</td>
</tr>
</tbody>
</table>
<h2 id="syntax">SYNTAX</h2>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy 
 [-EnableAutoExpirationVersionTrim &lt;Boolean&gt;]
 [-ExpireVersionsAfterDays &lt;UInt32&gt;]
 [-MajorVersions &lt;UInt32&gt;]
 [-MajorWithMinorVersions &lt;UInt32&gt;]
 [-InheritFromTenant]
 [-ApplyToNewDocumentLibraries]
 [-ApplyToExistingDocumentLibraries]
 [-CancelForExistingDocumentLibraries]
 [-Connection &lt;PnPConnection&gt;]
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>Configures the versioning policy for a SharePoint Online site collection.</p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy -EnableAutoExpirationVersionTrim $true
</code></pre>
<p>This example sets AutoExpiration file version trim mode for a site. The new document libraries will use this version setting. Also creates a request to set the file version trim mode as AutoExpiration for existing document libraries that enabled versioning.</p>
<h3 id="example-2">EXAMPLE 2</h3>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy -EnableAutoExpirationVersionTrim $false -MajorVersions 100 -MajorWithMinorVersions 10 -ExpireVersionsAfterDays 200
</code></pre>
<p>This example sets ExpireAfter file version trim mode for a site. The new document libraries will use this version setting. Also creates a request to set the file version trim mode as ExpireAfter for existing document libraries that enabled versioning.</p>
<h3 id="example-3">EXAMPLE 3</h3>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy -EnableAutoExpirationVersionTrim $false -MajorVersions 300 -MajorWithMinorVersions 20 -ExpireVersionsAfterDays 0
</code></pre>
<p>Example 3 sets NoExpiration file version trim mode for a site. The new document libraries will use this version setting. Also creates a request to set the file version trim mode as NoExpiration for existing document libraries that enabled versioning.</p>
<h3 id="example-4">EXAMPLE 4</h3>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy -InheritFromTenant
</code></pre>
<p>Example 4 clears the file version setting on a site. The new document libraries will use the tenant level setting.</p>
<h3 id="example-5">EXAMPLE 5</h3>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy -EnableAutoExpirationVersionTrim $true -ApplyToNewDocumentLibraries
</code></pre>
<p>This example sets AutoExpiration file version trim mode for a site. The new document libraries will use this version setting.</p>
<h3 id="example-6">EXAMPLE 6</h3>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy -EnableAutoExpirationVersionTrim $false -MajorVersions 100 -ExpireVersionsAfterDays 200 -ApplyToNewDocumentLibraries
</code></pre>
<p>This example sets ExpireAfter file version trim mode for a site. The new document libraries will use this version setting.</p>
<h3 id="example-7">EXAMPLE 7</h3>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy -EnableAutoExpirationVersionTrim $false -MajorVersions 300 -ExpireVersionsAfterDays 0 -ApplyToNewDocumentLibraries
</code></pre>
<p>Example 7 sets NoExpiration file version trim mode for a site. The new document libraries will use this version setting.</p>
<h3 id="example-8">EXAMPLE 8</h3>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy -EnableAutoExpirationVersionTrim $true -ApplyToExistingDocumentLibraries
</code></pre>
<p>Example 8 creates a request to set the file version trim mode as AutoExpiration for existing document libraries that enabled versioning.</p>
<h3 id="example-9">EXAMPLE 9</h3>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy -EnableAutoExpirationVersionTrim $false -MajorVersions 100 -MajorWithMinorVersions 5 -ExpireVersionsAfterDays 200 -ApplyToExistingDocumentLibraries
</code></pre>
<p>This example creates a request to set the file version trim mode as ExpireAfter for existing document libraries that enabled versioning.</p>
<h3 id="example-10">EXAMPLE 10</h3>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy -EnableAutoExpirationVersionTrim $false -MajorVersions 100 -MajorWithMinorVersions 5 -ExpireVersionsAfterDays 0 -ApplyToExistingDocumentLibraries
</code></pre>
<p>Example 10 creates a request to set the file version trim mode as NoExpiration for existing document libraries that enabled versioning.</p>
<h3 id="example-11">EXAMPLE 11</h3>
<pre><code class="lang-powershell">Set-PnPSiteVersionPolicy -CancelForExistingDocumentLibraries
</code></pre>
<p>This example cancels the existing request which sets the file version trim mode for existing document libraries on a site.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-applytonewdocumentlibraries">-ApplyToNewDocumentLibraries</h3>
<p>Sets site version policy for new document libraries. Works with parameters EnableAutoExpirationVersionTrim, ExpireVersionsAfterDays, MajorVersions and MajorWithMinorVersions.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: Set Properties

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-applytoexistingdocumentlibraries">-ApplyToExistingDocumentLibraries</h3>
<p>Creates a request to set the file version trim mode for existing document libraries that enabled versioning. Works with parameters EnableAutoExpirationVersionTrim, ExpireVersionsAfterDays, MajorVersions and MajorWithMinorVersions.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: Set Properties

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-cancelforexistingdocumentlibraries">-CancelForExistingDocumentLibraries</h3>
<p>Cancels the existing request which sets the file version trim mode for existing document libraries on a site.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: Set Properties

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-connection">-Connection</h3>
<p>Optional connection to be used by the cmdlet. Retrieve the value for this parameter by either specifying -ReturnConnection on Connect-PnPOnline or by executing Get-PnPConnection.</p>
<pre><code class="lang-yaml">Type: PnPConnection
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-enableautoexpirationversiontrim">-EnableAutoExpirationVersionTrim</h3>
<p>Enables or disables AutoExpiration version trim for the document libraries on the site. Set to $true to enable, $false to disable.</p>
<p>Parameter ExpireVersionsAfterDays is required when EnableAutoExpirationVersionTrim is false. Set it to 0 for NoExpiration, set it to greater or equal to 30 for ExpireAfter.</p>
<p>Parameter MajorVersions is required when EnableAutoExpirationVersionTrim is false.</p>
<p>Parameter MajorWithMinorVersions is required when EnableAutoExpirationVersionTrim is false and the setting is for document libraries that including existing ones. It is used when minor version is enabled on the document libraries.</p>
<pre><code class="lang-yaml">Type: Boolean
Parameter Sets: Set Properties

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-expireversionsafterdays">-ExpireVersionsAfterDays</h3>
<p>Expires the version after the days. Works with parameter EnableAutoExpirationVersionTrim. Please see description in EnableAutoExpirationVersionTrim.</p>
<pre><code class="lang-yaml">Type: UInt32
Parameter Sets: Set Properties

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-inheritfromtenant">-InheritFromTenant</h3>
<p>Clears the file version setting on a site. The new document libraries will use the tenant level setting.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: Set Properties

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-majorversions">-MajorVersions</h3>
<p>Maximum major versions to keep. Works with parameter EnableAutoExpirationVersionTrim. Please see description in EnableAutoExpirationVersionTrim.</p>
<pre><code class="lang-yaml">Type: UInt32
Parameter Sets: Set Properties

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-majorwithminorversions">-MajorWithMinorVersions</h3>
<p>Maximum major versions for which to keep minor versions. Works with parameter EnableAutoExpirationVersionTrim. Please see description in EnableAutoExpirationVersionTrim.</p>
<pre><code class="lang-yaml">Type: UInt32
Parameter Sets: Set Properties

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/m365pnp">Microsoft 365 Patterns and Practices</a></p>

</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
            <img src="https://m365-visitor-stats.azurewebsites.net/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "ag6usxufyq");
    </script>  </body>
</html>