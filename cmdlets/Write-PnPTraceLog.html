<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Write-PnPTraceLog | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Write-PnPTraceLog | PnP PowerShell ">
    <meta name="generator" content="docfx ">
  <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="../">
  <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Edit this page" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
  <h1 id="write-pnptracelog">Write-PnPTraceLog</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p>Allows logging your own messages during the execution of PnP PowerShell cmdlets</p>
<h2 id="syntax">SYNTAX</h2>
<h3 id="log-from-file">Log from file</h3>
<pre><code class="lang-powershell">Write-PnPTraceLog -Path &lt;string&gt; [-Verbose]
</code></pre>
<h3 id="log-from-log-stream">Log from log stream</h3>
<pre><code class="lang-powershell">Write-PnPTraceLog [-Verbose]
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>This cmdlet allows logging of your own messages in line with the PnPTraceLog cmdlets that allow logging what happens behind the scenes of the execution of PnP PowerShell cmdlets. This allows you to inject your own custom logging along with the built in logging to get a complete and chronoligal log of the execution of the cmdlets in your scripts.</p>
<p>Look at <a href="Start-PnPTraceLog.html">Start-PnPTraceLog</a> to see how to start logging to a file and/or to an in memory stream.
You can use <a href="Get-PnPTraceLog.html">Get-PnPTraceLog</a> to read from the log file or the in memory stream.</p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<pre><code class="lang-powershell">Write-PnPTraceLog &quot;Hello World&quot;
</code></pre>
<p>This logs the message &quot;Hello World&quot; as an informational message to the built in logging.</p>
<h3 id="example-2">EXAMPLE 2</h3>
<pre><code class="lang-powershell">Write-PnPTraceLog &quot;Hello World&quot; -Level Warning
</code></pre>
<p>This logs the message &quot;Hello World&quot; as an warning message to the built in logging.</p>
<h3 id="example-3">EXAMPLE 3</h3>
<pre><code class="lang-powershell">Write-PnPTraceLog &quot;Hello World&quot; -Level Error -Source &quot;MyScript&quot;
</code></pre>
<p>This logs the message &quot;Hello World&quot; as an error message to the built in logging with a source of &quot;MyScript&quot;. The source is used to identify the cmdlet that was executed when the log was created. This is useful to identify which part of your script was executing when the log was created.</p>
<h3 id="example-4">EXAMPLE 4</h3>
<pre><code class="lang-powershell">Write-PnPTraceLog &quot;Hello World&quot; -Level Debug -Source &quot;MyScript&quot; -CorrelationId &quot;5a6206a0-6c83-4446-9d1b-38c14f93cb60&quot; -EllapsedMilliseconds 1000
</code></pre>
<p>This is the most complete example. It logs the message &quot;Hello World&quot; as a debug message to the built in logging with a source of &quot;MyScript&quot;, a correlation id of &quot;5a6206a0-6c83-4446-9d1b-38c14f93cb60&quot; and an ellapsed time of 1000 milliseconds. The correlation id is used to identify the set of operations that were executed when the log was created. The ellapsed time is used to identify how long the operation took to complete. You can provide your own measurements to define this value. If you omit the ellapsed time, the cmdlet will try to define the execution time based on the last logged entry.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-correlationid">-CorrelationId</h3>
<p>An optional GUID as an unique identifier for the cmdlet execution. This is useful to identify which part of your script was executing when the log was created. If not provided, it will leave the value empty.</p>
<pre><code class="lang-yaml">Type: Guid
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-ellapsedmilliseconds">-EllapsedMilliseconds</h3>
<p>You can optionaly provide the ellapsed time in milliseconds. This is the time that was taken to execute the operation. If you omit this parameter, the cmdlet will try to define the execution time based on the last logged entry.</p>
<pre><code class="lang-yaml">Type: Long
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-level">-Level</h3>
<p>The level to log your message under. Options are: Verbose, Information, Warning, Error and Debug. It will log it both to the default PowerShell its logging equivallent such as Write-Warning, Write-Error, Write-Verbose, and to the PnPTraceLog logging. If not provided, it will default to Information.</p>
<pre><code class="lang-yaml">Type: Framework.Diagnostics.LogLevel
Parameter Sets: (All)

Required: False
Position: Named
Default value: Information
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-message">-Message</h3>
<p>The message to log. This is the message that will be logged to the log file or the in memory stream.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: True
Position: Named
Default value: None
Accept pipeline input: True
Accept wildcard characters: False
</code></pre>
<h3 id="-source">-Source</h3>
<p>The source of the log. This is the source that will be logged to the log file or the in memory stream. This is useful to identify which part of your script was executing when the log was created.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-verbose">-Verbose</h3>
<p>When provided, additional debug statements will be shown while executing the cmdlet.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/m365pnp">Microsoft 365 Patterns and Practices</a></p>

</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
            <img src="https://m365-visitor-stats.azurewebsites.net/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "ag6usxufyq");
    </script>  </body>
</html>