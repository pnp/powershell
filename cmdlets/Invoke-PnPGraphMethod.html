<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Invoke-PnPGraphMethod | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Invoke-PnPGraphMethod | PnP PowerShell ">
    <meta name="generator" content="docfx ">
  <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="../">
  <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Edit this page" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
  <h1 id="invoke-pnpgraphmethod">Invoke-PnPGraphMethod</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p>Invokes a REST request towards the Microsoft Graph API</p>
<h2 id="syntax">SYNTAX</h2>
<h3 id="out-to-console-default">Out to console (Default)</h3>
<pre><code class="lang-powershell">Invoke-PnPGraphMethod -Url &lt;String&gt;
                      [-AdditionalHeaders GraphAdditionalHeadersPipeBind]
                      [[-Method] &lt;HttpRequestMethod&gt;] 
                      [-Content &lt;Object&gt;] 
                      [-ContentType &lt;String&gt;] 
                      [-ConsistencyLevelEventual] 
                      [-Raw]
                      [-All] 
                      [-Connection &lt;PnPConnection&gt;]
                      [-Verbose]
</code></pre>
<h3 id="out-to-file">Out to file</h3>
<pre><code class="lang-powershell">Invoke-PnPGraphMethod -Url &lt;String&gt;
                      [-AdditionalHeaders GraphAdditionalHeadersPipeBind]
                      [[-Method] &lt;HttpRequestMethod&gt;] 
                      [-Content &lt;Object&gt;] 
                      [-ContentType &lt;String&gt;] 
                      [-ConsistencyLevelEventual] 
                      [-Connection &lt;PnPConnection&gt;]
                      [-OutFile &lt;String&gt;]
                      [-Verbose]
</code></pre>
<h3 id="out-to-stream">Out to stream</h3>
<pre><code class="lang-powershell">Invoke-PnPGraphMethod -Url &lt;String&gt;
                      [-AdditionalHeaders GraphAdditionalHeadersPipeBind]
                      [[-Method] &lt;HttpRequestMethod&gt;] 
                      [-Content &lt;Object&gt;] 
                      [-ContentType &lt;String&gt;] 
                      [-ConsistencyLevelEventual] 
                      [-Connection &lt;PnPConnection&gt;]
                      [-OutStream]
                      [-Verbose]
</code></pre>
<h3 id="batch">Batch</h3>
<pre><code class="lang-powershell">Invoke-PnPGraphMethod -Url &lt;String&gt;
                      [-AdditionalHeaders GraphAdditionalHeadersPipeBind]
                      [[-Method] &lt;HttpRequestMethod&gt;] 
                      [-Content &lt;Object&gt;] 
                      [-ContentType &lt;String&gt;] 
                      [-ConsistencyLevelEventual] 
                      [-Connection &lt;PnPConnection&gt;]
                      [-Batch &lt;PnPBatch&gt;]                      
                      [-Verbose]
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>Invokes a REST request towards the Microsoft Graph API. It will take care of potential throttling retries that are needed to retrieve the data.</p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">Example 1</h3>
<pre><code class="lang-powershell">Invoke-PnPGraphMethod -Url &quot;groups?`$filter=startsWith(displayName,'ZZ')&amp;`$select=displayName&quot;
Invoke-PnPGraphMethod -Url 'groups/{id}?`$select=hideFromOutlookClients'
</code></pre>
<p>Execute a GET request to get groups by filter and select.</p>
<h3 id="example-2">Example 2</h3>
<pre><code class="lang-powershell">Invoke-PnPGraphMethod -Url &quot;groups/{id}&quot; -Method Delete
</code></pre>
<p>Delete the group with the specified id.</p>
<h3 id="example-3">Example 3</h3>
<pre><code class="lang-powershell">Invoke-PnPGraphMethod -Url &quot;groups/{id}&quot; -Method Patch -Content @{ displayName = &quot;NewName&quot; }
</code></pre>
<p>Set the new displayName of the group with a Patch request.</p>
<h3 id="example-4">Example 4</h3>
<pre><code class="lang-powershell">Invoke-PnPGraphMethod -Url &quot;users?`$filter=accountEnabled ne true&amp;`$count=true&quot; -Method Get -ConsistencyLevelEventual
</code></pre>
<p>Get users with advanced query capabilities. Use of -ConsistencyLevelEventual.</p>
<h3 id="example-5">Example 5</h3>
<pre><code class="lang-powershell">Invoke-PnPGraphMethod -Url &quot;users&quot;
</code></pre>
<p>Performs a GET request to retrieve users from the Microsoft Graph API using the full URL.</p>
<h3 id="example-6">Example 6</h3>
<pre><code class="lang-powershell">Invoke-PnPGraphMethod -Url &quot;users/user@contoso.com/photo/`$value&quot; -OutFile c:\temp\photo.jpg
</code></pre>
<p>Downloads the user profile photo of the specified user to the specified file.</p>
<h3 id="example-7">Example 7</h3>
<pre><code class="lang-powershell">Invoke-PnPGraphMethod -Url &quot;users/user@contoso.com/photo/`$value&quot; -OutStream | Add-PnPFile -FileName user.jpg -Folder &quot;Shared Documents&quot;
</code></pre>
<p>Takes the user profile photo of the specified user and uploads it to the specified library in SharePoint Online.</p>
<h3 id="example-8">Example 8</h3>
<pre><code class="lang-powershell">$task = Invoke-PnPGraphMethod -Url &quot;planner/tasks/23fasefxcvzvsdf32e&quot; # retrieve the task so we can figure out the etag which is needed to update the task
$etag = $task.'@odata.etag'
$headers = @{&quot;If-Match&quot;=$etag} 
$content = @{&quot;title&quot;=&quot;My new task title&quot;}
Invoke-PnPGraphMethod -Url &quot;planner/tasks/23fasefxcvzvsdf32e&quot; -Method PATCH -Content $content -AdditionalHeaders $headers
</code></pre>
<p>This example retrieves a Planner task to find the etag value which is required to update the task. In order to update the task through call to the Microsoft Graph API we need to include an If-Match header with the value of the etag. It then creates the content to update, in this case the title of the task, and calls the PATCH method on the Graph end-point to update the specific task.</p>
<h3 id="example-9">EXAMPLE 9</h3>
<pre><code class="lang-powershell">$batch = New-PnPBatch -RetainRequests
Invoke-PnPSPRestMethod -Method Get -Url &quot;users&quot; -Batch $batch
Invoke-PnPSPRestMethod -Method Get -Url &quot;groups&quot; -Batch $batch
$response = Invoke-PnPBatch $batch -Details
$response
</code></pre>
<p>This example executes a GET request to get all users and a groups in a single batch request.
It is necessary to create and invoke batch requests in the manner specified here if you want to process something later on with the response object.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-additionalheaders">-AdditionalHeaders</h3>
<p>Additional request headers, either by providing a Dictionary&lt;string,string&gt; or a Hastable, .e.g -AdditionalHeaders @{&quot;If-Match&quot;=&quot;234567tysfssdvsadf&quot;}</p>
<pre><code class="lang-yaml">Type: GraphAdditionalHeaderPipeBind
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-all">-All</h3>
<p>Retrieve all pages of results. This will loop through all @odata.nextLink. This flag will only be respected if the request is a GET request.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: Out to console
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-connection">-Connection</h3>
<p>Optional connection to be used by the cmdlet.
Retrieve the value for this parameter by either specifying -ReturnConnection on Connect-PnPOnline or by executing Get-PnPConnection.</p>
<pre><code class="lang-yaml">Type: PnPConnection
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-consistencyleveleventual">-ConsistencyLevelEventual</h3>
<p>Set the ConsistencyLevel header to eventual for advanced query capabilities on Azure AD directory objects</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-content">-Content</h3>
<p>A string or object to send</p>
<pre><code class="lang-yaml">Type: Object
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-contenttype">-ContentType</h3>
<p>The content type of the object to send. Defaults to 'application/json'.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-method">-Method</h3>
<p>The HTTP method to execute. Defaults to GET.</p>
<pre><code class="lang-yaml">Type: HttpRequestMethod
Parameter Sets: (All)
Aliases:
Accepted values: Default, Get, Head, Post, Put, Delete, Trace, Options, Merge, Patch

Required: False
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-outfile">-OutFile</h3>
<p>The full path including filename to write the output to, i.e. c:\temp\myfile.txt. Existing files will be overwritten.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Out to file
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-outstream">-OutStream</h3>
<p>Indicates that the result of the request should be returned as a memory stream.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Out to stream
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-raw">-Raw</h3>
<p>If specified the returned data will not be converted to an object but returned as a JSON string.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: Out to console
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-url">-Url</h3>
<p>The Graph endpoint to invoke.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: True (ByValue)
Accept wildcard characters: False
</code></pre>
<h3 id="-batch">-Batch</h3>
<p>The batch to add this request to.</p>
<pre><code class="lang-yaml">Type: PnPBatch
Parameter Sets: Batched

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/m365pnp">Microsoft 365 Patterns and Practices</a></p>

</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
            <img src="https://m365-visitor-stats.azurewebsites.net/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "ag6usxufyq");
    </script>  </body>
</html>